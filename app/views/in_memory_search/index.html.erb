<div class="container">
  <h1 class="">Simple In-Memory Search</h1>
  <%= form_with method: :get do |f| %>
    <%= f.text_field :q, placeholder: 'search', value: params[:q], class: 'rounded-md py-1 border-indigo-200' %>
    <%= f.submit class: 'border border-indigo-500 bg-indigo-500 text-white rounded-md px-4 py-1 m-2 transition duration-200 ease select-none hover:bg-indigo-600 focus:outline-none focus:shadow-outline' do %>
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
      </svg>
    <% end %>
  <% end %>

  <p>Searched for "<span class="font-semibold text-indigo-500"><%= params[:q] %></span>" and got <%= @results.count %> records</p>
  <table class="table-auto mt-4 results">
    <thead class="border-b-2">
      <tr class="mt-2 mb-1">
        <% @results.first&.keys&.each do |key| %>
            <th class="px-2 pb-0 text-left font-medium text-gray-900"><%= key.titleize %></th>
        <% end %>
      </tr>
    </thead>

    <tbody>
      <% @results.each_with_index do |result, i| %>
        <tr class="hover:bg-indigo-200 hover:text-gray-900">
          <% result.values.each do |value| %>
            <td class="px-2 truncate overflow-ellipsis max-w-xs py-1 <%= i == 0 ? 'pt-3' : '' %>"><%= value&.html_safe %></td>
          <% end %>
        </tr>
      <% end %>
    <tbody>
  </table>
</div>
